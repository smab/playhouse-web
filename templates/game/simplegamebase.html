{% extends "base.html" %}


{% block playground %}
<div style="margin: 0 auto;"> 
    <style> 
    #player0,#player1 {
        width: 100px; 
        height: 175px; 
        padding: 8px; 
        margin: 2em; 
        display: inline-block; 
        text-align: center; 
    }
    #player0 div,#player1 div {
        width: 64px; 
        height: 64px; 
        margin: 0 auto; 
    }
    {% if color_1 != None %}
    #player0color {
        background-color: {{ color_1 }}
    }
    #player1color {
        background-color: {{ color_2 }}
    } 
    {% else %}
    #player0color, #player1color {
        display: none; 
    } 
    {% end %} 
    #player0time, #player1time { 
        {% if timelimit == None %}
        display: none; 
        {% end %}
    }
    #player0score, #player1score {
        {% if score_1 == None %}
        display: none;  
        {% end %}
    }

    #grid { 
        margin: 0 auto; 
        display: inline-block; 
    }

    </style> 
    <div id="player0" style="border: 1px dashed #333">
        <div id="player0color"></div>
        <p style="text-align: center; font-weight: bold">Player 1</p> 
        <p id="player0score">Score: {{ score_1 }}</p> 
        <p id="player0time">Time: {{ timelimit }}</p> 
    </div> 

    <table id="grid"></table> 

    <div id="player1" style="border: 0px dashed #333">
        <div id="player1color"></div>
        <p style="text-align: center; font-weight: bold">Player 2</p> 
        <p id="player1score">Score: {{ score_2 }}</p> 
        <p id="player1time">Time: {{ timelimit }}</p> 
    </div> 
</div> 
{% end %}

{% block timelimits %}
function changeTurn(p) {
    player = p 
    var pl   = document.getElementById("player"+p)
    var op = document.getElementById("player"+(1-p))
  
    // Set current player indication 
    // TODO Set the opponent's border to 1px (so it does not jump around during turnover 
    pl.setAttribute(  "style", "border: 1px dashed #333!important"); 
    op.setAttribute("style", "border: 0px dashed #333!important"); 
} 
function changeTime(p, t) {
    time = t
    document.getElementById("player"+p+"time").innerHTML = "Time: " + time 
}
function decreaseTime() {
    time -= 1; 
    changeTime(player, time); 
}

if(obj.x == undefined) 
    console.log(obj) 

function changeScore(p, s) {
    document.getElementById("player"+p+"score").innerHTML = "Score: " + s
}


if(obj.score_1 != undefined) {
    changeScore(0, obj.score_1) 
}

if(obj.score_2 != undefined) {
    changeScore(1, obj.score_2) 
}

if(obj.turn != undefined) {
    if(handler != undefined) {
        window.clearInterval(handler) 
        handler = undefined 
    }
    changeTime(player, {{ timelimit }}) 
    changeTurn(obj.turn) 
}

if(obj.timeleft != undefined) {
    if(handler != undefined) {
        window.clearInterval(handler) 
    }
    changeTime(player, obj.timeleft) 
    handler = window.setInterval(decreaseTime, 1000); 
}


if(obj.pause != undefined) {
    if(obj.pause) {
        window.clearInterval(handler) 
        handler = undefined 
    }
    else {
        handler = window.setInterval(decreaseTime, 1000) 
    }
}


if(obj.gamestate == 'reset') {
    if(handler != undefined) {
        window.clearInterval(handler) 
    }
    changeTime(0, {{ timelimit }}) 
    changeTime(1, {{ timelimit }}) 
    changeScore(0, 0) 
    changeScore(1, 0)
    changeTurn(0) 
} 

{% end %}



