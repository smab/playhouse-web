{% extends config_base.html %}


{% block menu_settings %}active{% end %}


{% block configstyle %}
    #message {
        position: absolute;
        top: 0px;
        left: 0px;
        right: 0px;
        width: 100%;
        padding: 0.4em 0;
        text-align: center;
        box-shadow: 0 0 8px #222;
        font-family: sans-serif;
        background: rgba(255,255,255,0.3);
    }
    #message.type-error {
        font-weight: bold;
        background: rgba(255,0,0,0.6);
    }
    .hidden {
        display: none;
    }
{% end %}


{% block configscript %}
    function onnamechange(e) {
        set_state(e.value != '{{ game_name }}');
    }
    function onpathchange(e) {
        set_state(e.value != '{% raw game_path %}');
    }
    function set_state(change_game) {
        config = document.getElementById("gameconfig");
        save = document.getElementById("savebutton");
        if (change_game) {
            config.className = "hidden";
            save.value = "Change Game";
        } else {
            config.className = "";
            save.value = "Save Settings";
        }
    }
{% end %}


{% block configbody %}
    {% if status != "" %}
        <div id="message" class="type-{{ status }}">{{ message }}</div>
    {% end %}
    <h1>Settings</h1>
    <form enctype="multipart/form-data" action="/config/game" method="post">
        <h2>Game Choice</h2>
        <table>
        <tr>
            <td>Current Game: </td>
            <td>
                <select id="name" name="game_name" value="{{ game_name }}" onchange="onnamechange(this)">
                {% for name in game_list %}
                    <option value="{{ name }}" {% if name==game_name %}selected{% end %}>{{ name }}</option>
                {% end %}
                </select>
            </td>
        </tr><tr>
            <td>Game Paths: </td>
            <td><input id="path" name="game_path" value="{{ game_path }}" onchange="onpathchange(this)" /></td>
        </tr>
        </table>

        <div id="gameconfig">
        {% module Template("config/" + config_file, **vars) %}
        </div>

        <ul id="buttons">
            <li><input type="submit" id="savebutton" value="Save Settings"></li>
        </ul>
    </form>
{% end %}
